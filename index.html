<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLEAN IP | √êŒõ…å‚Ç≠·ëéŒûêí°êí°</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Variables for theming */
        :root {
            --bg-color: #0d1117;
            --bg-gradient: radial-gradient(circle, #1a2027 0%, #0d1117 100%);
            --glass-bg: rgba(13, 17, 23, 0.6);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --header-title-color: #58a6ff;
            --header-shadow: 0 0 30px rgba(88, 166, 255, 0.5);
            --ip-group-title: #e3b3ff;
            --ip-group-shadow: 0 0 12px rgba(227, 179, 255, 0.5);
            --ip-group-rgb: 227, 179, 255; /* For neon effect */
            --ip-text-color: #c9d1d9;
            --ip-box-bg: rgba(22, 27, 34, 0.7);
            --ip-box-hover-bg: rgba(30, 36, 44, 0.8);
            --btn-active-color: #e6edf3;
            --btn-indicator-bg: #58a6ff;
            --copy-btn-bg: #238636;
            --copy-btn-color: #ffffff;
            --copy-btn-hover-bg: #2ea043;
            --matrix-bg: rgba(13, 17, 23, 0.05);
            --theme-switcher-bg: #21262d;
            --sun-color: #ffc107;
            --moon-color: #58a6ff;
            --toast-bg: #2ea043;
            --toast-color: #ffffff;
        }

        body.light-theme {
            --bg-color: #f0f2f5;
            --bg-gradient: radial-gradient(circle, #ffffff 0%, #e9eef3 100%);
            --glass-bg: rgba(255, 255, 255, 0.6);
            --glass-border: rgba(0, 0, 0, 0.1);
            --text-primary: #1c1c1c;
            --text-secondary: #555;
            --header-title-color: #0062cc;
            --header-shadow: 0 0 20px rgba(0, 98, 204, 0.4);
            --ip-group-title: #7928ca;
            --ip-group-shadow: 0 0 10px rgba(121, 40, 202, 0.4);
            --ip-group-rgb: 121, 40, 202; /* For neon effect */
            --ip-text-color: #333;
            --ip-box-bg: rgba(255, 255, 255, 0.7);
            --ip-box-hover-bg: rgba(245, 245, 245, 0.9);
            --btn-active-color: #ffffff;
            --btn-indicator-bg: #0062cc;
            --copy-btn-bg: #0062cc;
            --copy-btn-hover-bg: #005cbf;
            --matrix-bg: rgba(240, 242, 245, 0.1);
            --theme-switcher-bg: #e9eef3;
            --sun-color: #0062cc;
            --moon-color: #333;
            --toast-bg: #0062cc;
        }

        /* General Styles */
        body {
            font-family: 'Vazirmatn', sans-serif;
            background: var(--bg-gradient);
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            transition: background 0.5s, color 0.5s;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        #matrix-canvas {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            pointer-events: none; z-index: -1; opacity: 0.1;
        }

        /* Glassmorphism Container */
        .glass-container {
            background: var(--glass-bg);
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border); border-radius: 20px;
            padding: 30px; width: 90%; max-width: 800px; z-index: 1;
            box-sizing: border-box; margin-bottom: 25px;
            transition: background 0.5s, border 0.5s;
            animation: fadeIn 0.8s ease-out forwards;
        }

        /* Header */
        .header-container {
            text-align: center; box-shadow: var(--header-shadow); position: relative;
            border-bottom: 2px solid var(--header-title-color);
        }
        .header-container h1 {
            margin: 0; font-size: 2.5rem; letter-spacing: 3px;
            color: var(--header-title-color); font-weight: 700;
            text-shadow: 0 0 15px var(--header-title-color);
            animation: glow 2s infinite alternate;
        }
        @keyframes glow { from { text-shadow: 0 0 10px var(--header-title-color); } to { text-shadow: 0 0 25px var(--header-title-color); } }

        /* --- SPECIAL THEME SWITCHER --- */
        .theme-switcher {
            position: absolute; top: 50%; right: 25px; transform: translateY(-50%);
        }
        .theme-switcher-label {
            display: block; width: 60px; height: 30px;
            background: var(--theme-switcher-bg); border-radius: 15px;
            cursor: pointer; position: relative;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.2);
            transition: background 0.4s;
        }
        .theme-switcher-ball {
            position: absolute; top: 3px; left: 3px;
            width: 24px; height: 24px;
            background: #fff; border-radius: 50%;
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        .theme-switcher-input { display: none; }
        .theme-switcher-input:checked + .theme-switcher-label .theme-switcher-ball {
            transform: translateX(30px);
        }
        .sun-icon, .moon-icon {
            position: absolute; top: 50%; transform: translateY(-50%);
            width: 18px; height: 18px;
            transition: opacity 0.4s, color 0.4s;
        }
        .sun-icon { left: 6px; color: var(--sun-color); opacity: 0; }
        .moon-icon { right: 6px; color: var(--moon-color); opacity: 1; }
        .theme-switcher-input:checked + .theme-switcher-label .sun-icon { opacity: 1; }
        .theme-switcher-input:checked + .theme-switcher-label .moon-icon { opacity: 0; }

        /* --- SPECIAL BUTTONS CONTAINER (RTL FIX) --- */
        .buttons-container {
            display: flex; position: relative; background: var(--ip-box-bg);
            border-radius: 12px; padding: 5px; margin-bottom: 25px;
            z-index: 1; animation: fadeIn 1s ease-out forwards;
        }
        .buttons-container::before { /* The sliding indicator */
            content: ''; position: absolute; top: 5px; bottom: 5px;
            width: calc(50% - 5px); background: var(--btn-indicator-bg);
            border-radius: 8px;
            right: 5px; /* Default position for RTL (rightmost button, IPv4) */
            transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 15px var(--btn-indicator-bg);
        }
        .buttons-container.ipv6-active::before {
             right: 50%; /* Position for leftmost button (IPv6) */
        }
        .toggle-btn {
            flex: 1; padding: 12px 20px; border-radius: 8px; border: none;
            font-size: 1.1rem; font-weight: 600; cursor: pointer;
            background: transparent; color: var(--text-secondary);
            transition: color 0.4s; z-index: 2; user-select: none;
        }
        .toggle-btn.active {
            color: var(--btn-active-color);
            text-shadow: 0 0 5px rgba(0,0,0,0.5);
        }

        /* IPs Container */
        .ips-container {
            min-height: 300px; padding: 30px;
            animation: fadeIn 1.2s ease-out forwards;
        }
        .ip-group h2 {
            text-align: center; margin-top: 0; margin-bottom: 25px;
            font-weight: 700; font-size: 2.2rem; color: var(--ip-group-title);
            text-shadow: var(--ip-group-shadow);
        }

        /* --- IP BOX NEON STYLE --- */
        .ip-box {
            display: flex; align-items: center; justify-content: space-between;
            background-color: var(--ip-box-bg); border-radius: 12px;
            padding: 15px 20px; margin-bottom: 15px;
            border: 1px solid rgba(var(--ip-group-rgb), 0.3);
            box-shadow: 0 0 10px rgba(var(--ip-group-rgb), 0.2), 0 2px 5px rgba(0,0,0,0.2);
            transition: transform 0.3s, box-shadow 0.3s, border-color 0.3s, background-color 0.4s;
        }
        .ip-box:hover {
            transform: translateY(-4px) scale(1.01);
            border-color: rgba(var(--ip-group-rgb), 0.6);
            box-shadow: 0 0 20px rgba(var(--ip-group-rgb), 0.4), 0 4px 10px rgba(0,0,0,0.3);
            background-color: var(--ip-box-hover-bg);
        }
        .ip-text {
            font-family: 'Courier New', Courier, monospace; font-size: 1.1rem;
            color: var(--ip-text-color); word-break: break-all;
            flex-grow: 1; text-align: left; direction: ltr;
        }
        .copy-btn {
            margin-right: 15px; padding: 10px; border: none;
            border-radius: 10px; background: var(--copy-btn-bg);
            color: var(--copy-btn-color);
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            transition: background-color 0.3s, transform 0.2s;
            user-select: none; flex-shrink: 0;
            width: 40px; height: 40px;
        }
        .copy-btn svg {
            width: 22px; height: 22px;
            fill: var(--copy-btn-color); transition: fill 0.3s;
        }
        .copy-btn:hover { background-color: var(--copy-btn-hover-bg); transform: scale(1.1); }
        
        /* --- TOAST NOTIFICATION --- */
        #toast {
            position: fixed;
            bottom: -100px; /* Initially hidden */
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--toast-bg);
            color: var(--toast-color);
            padding: 12px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            font-size: 1rem;
            font-weight: 600;
            z-index: 1000;
            transition: bottom 0.5s ease-in-out;
        }
        #toast.show {
            bottom: 30px;
        }

        /* --- LOGO ICON RESTORED --- */
        #dark-icon {
            position: fixed; bottom: 20px; left: 20px;
            width: 50px; height: 50px;
            border-radius: 50%;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            cursor: pointer; z-index: 10;
            transition: transform 0.3s ease, box-shadow 0.3s;
            /* Your logo is here */
            background-image: url('https://raw.githubusercontent.com/darknessm427/Hiddify-warp/main/Darkness.png');
            background-size: 70%;
            background-position: center;
            background-repeat: no-repeat;
        }
        #dark-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px var(--header-title-color);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body { padding: 15px; }
            .glass-container, .ips-container { padding: 20px; width: 95%; }
            .header-container { flex-direction: column; align-items: center; }
            .header-container h1 { font-size: 1.8rem; margin-bottom: 15px; }
            .theme-switcher { position: static; transform: none; margin-top: 0; }
            .ip-group h2 { font-size: 1.8rem; }
            .ip-text { font-size: 1rem; }
        }
        @media (max-width: 480px) {
            .ip-box { flex-direction: column; align-items: flex-start; gap: 10px; }
            .copy-btn { margin-right: 0; align-self: flex-end; }
            .ip-text { width: 100%; }
        }
    </style>
</head>
<body>

    <canvas id="matrix-canvas"></canvas>
    <div id="toast"></div>

    <div class="glass-container header-container">
        <h1>CLEAN IP</h1>
        <div class="theme-switcher">
            <input type="checkbox" id="theme-toggle-checkbox" class="theme-switcher-input">
            <label for="theme-toggle-checkbox" class="theme-switcher-label">
                <div class="theme-switcher-ball"></div>
                <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.64 5.64c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41zm12.72 12.72c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41zM5.64 18.36c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0zM18.36 5.64c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0z"/></svg>
                <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M9.37 5.51A7.35 7.35 0 0 0 9.1 7.5c0 4.08 3.32 7.4 7.4 7.4.68 0 1.35-.09 1.99-.27C17.45 17.19 14.93 19 12 19A7 7 0 0 1 12 5c.93 0 1.81.21 2.63.58-.45.28-.85.64-1.26 1.07z"/></svg>
            </label>
        </div>
    </div>

    <div class="buttons-container">
        <button id="btn-ipv4" class="toggle-btn active">IPv4</button>
        <button id="btn-ipv6" class="toggle-btn">IPv6</button>
    </div>

    <div class="ips-container">
        <div id="ipv4-group" class="ip-group"></div>
        <div id="ipv6-group" class="ip-group" style="display:none;"></div>
    </div>

    <a id="dark-icon" href="https://t.me/darkness_427" target="_blank" rel="noopener noreferrer" title="⁄©ÿßŸÜÿßŸÑ ÿ™ŸÑ⁄Øÿ±ÿßŸÖ"></a>

    <script>
        // This is the single, consolidated script to prevent conflicts.

        // --- Theme Switcher Logic ---
        (function() {
            const themeToggle = document.getElementById('theme-toggle-checkbox');
            const currentTheme = localStorage.getItem('theme');

            if (currentTheme) {
                document.body.classList.add(currentTheme);
                if (currentTheme === 'light-theme') {
                    themeToggle.checked = true;
                }
            }

            themeToggle.addEventListener('change', function() {
                document.body.classList.toggle('light-theme', this.checked);
                localStorage.setItem('theme', this.checked ? 'light-theme' : 'dark-theme');
            });
        })();

        // --- Matrix Background Logic ---
        (function() {
            const canvas = document.getElementById('matrix-canvas');
            const ctx = canvas.getContext('2d');

            let width, height;
            function resize() {
                width = window.innerWidth;
                height = window.innerHeight;
                if (canvas) {
                    canvas.width = width;
                    canvas.height = height;
                }
            }
            window.addEventListener('resize', resize);
            resize();

            const matrixChars = ['√êŒõ…å‚Ç≠·ëéŒûêí°êí°'];
            const fontSize = 12;
            const columns = Math.floor(width / fontSize);
            const drops = [];
            for (let x = 0; x < columns; x++) {
                drops[x] = Math.random() * height / fontSize;
            }
            const colors = [ '#975cf7', '#00ffff', '#007fff' ];

            function draw() {
                ctx.fillStyle = getComputedStyle(document.body).getPropertyValue('--matrix-bg').trim() || 'rgba(18, 18, 18, 0.1)';
                ctx.fillRect(0, 0, width, height);
                ctx.font = fontSize + 'px monospace';
                ctx.textBaseline = 'top';

                for (let i = 0; i < columns; i++) {
                    const char = matrixChars[Math.floor(Math.random() * matrixChars.length)];
                    const color = colors[i % colors.length];
                    ctx.fillStyle = color;
                    ctx.fillText(char, i * fontSize, drops[i] * fontSize);
                    drops[i] += 0.3;
                    if (drops[i] * fontSize > height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                }
            }
            if (canvas) {
                setInterval(draw, 50);
            }
        })();

        // --- IP Loading and Display Logic (Consolidated and Fixed with Robust Copy) ---
        (function() {
            const url = 'https://raw.githubusercontent.com/darknessm427/IP_Generator/refs/heads/main/ips.txt';
            const ipv4Group = document.getElementById('ipv4-group');
            const ipv6Group = document.getElementById('ipv6-group');
            const btnIPv4 = document.getElementById('btn-ipv4');
            const btnIPv6 = document.getElementById('btn-ipv6');
            const buttonsContainer = document.querySelector('.buttons-container');
            const toast = document.getElementById('toast');

            let ipv4IPs = [];
            let ipv6IPs = [];
            let toastTimer;

            function showToast(message) {
                if (toastTimer) clearTimeout(toastTimer); // Clear previous timer
                toast.textContent = message;
                toast.classList.add('show');
                toastTimer = setTimeout(() => {
                    toast.classList.remove('show');
                }, 2000); // Message disappears after 2 seconds
            }

            async function loadIPs() {
                try {
                    const response = await fetch(url);
                    const text = await response.text();
                    const ips = text.split('\n').map(ip => ip.trim()).filter(ip => ip !== '');

                    ipv4IPs = [];
                    ipv6IPs = [];

                    ips.forEach(ip => {
                        if (ip.startsWith('IPv4:') || ip.startsWith('IPv6:')) {
                            return;
                        }
                        if (ip.includes('.')) {
                            ipv4IPs.push(ip);
                        } else {
                            ipv6IPs.push(ip);
                        }
                    });
                    renderIPs('ipv4'); // Initial render
                } catch (e) {
                    if(ipv4Group) ipv4Group.textContent = ' ÿÆÿ∑ÿß ÿØÿ± ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿ¢€å‚ÄåŸæ€å‚ÄåŸáÿß ';
                    if(ipv6Group) ipv6Group.textContent = ' ÿÆÿ∑ÿß ÿØÿ± ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿ¢€å‚ÄåŸæ€å‚ÄåŸáÿß ';
                    console.error(e);
                }
            }

            function createIPBox(ip) {
                const div = document.createElement('div');
                div.className = 'ip-box';

                const span = document.createElement('span');
                span.className = 'ip-text';
                span.textContent = ip;

                const btn = document.createElement('button');
                btn.className = 'copy-btn';
                btn.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-1 16H9V8h9v13z"/></svg>`;

                btn.onclick = () => {
                    // --- ROBUST COPY METHOD ---
                    const textArea = document.createElement("textarea");
                    textArea.value = ip;
                    // Make the textarea invisible
                    textArea.style.position = "fixed";
                    textArea.style.top = "-9999px";
                    textArea.style.left = "-9999px";
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                    try {
                        document.execCommand('copy');
                        showToast('⁄©Ÿæ€å ÿ¥ÿØ!');
                    } catch (err) {
                        showToast('ÿÆÿ∑ÿß ÿØÿ± ⁄©Ÿæ€å!');
                        console.error('Fallback: Oops, unable to copy', err);
                    }
                    document.body.removeChild(textArea);
                };

                div.appendChild(span);
                div.appendChild(btn);

                return div;
            }

            function renderIPs(type) {
                if (type === 'ipv4') {
                    ipv4Group.style.display = 'block';
                    ipv6Group.style.display = 'none';
                    ipv4Group.innerHTML = '<h2>IPv4</h2>';
                    ipv4IPs.forEach(ip => ipv4Group.appendChild(createIPBox(ip)));

                    btnIPv4.classList.add('active');
                    btnIPv6.classList.remove('active');
                    buttonsContainer.classList.remove('ipv6-active');
                } else {
                    ipv6Group.style.display = 'block';
                    ipv4Group.style.display = 'none';
                    ipv6Group.innerHTML = '<h2>IPv6</h2>';
                    ipv6IPs.forEach(ip => ipv6Group.appendChild(createIPBox(ip)));

                    btnIPv6.classList.add('active');
                    btnIPv4.classList.remove('active');
                    buttonsContainer.classList.add('ipv6-active');
                }
            }
            
            btnIPv4.addEventListener('click', () => renderIPs('ipv4'));
            btnIPv6.addEventListener('click', () => renderIPs('ipv6'));

            loadIPs();
        })();
    </script>

</body>
</html>
